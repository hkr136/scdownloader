# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: Client ID Rotation

## –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 1. –ü–æ–ª—É—á–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ Client ID

**–ú–µ—Ç–æ–¥ 1: –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä**
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://soundcloud.com
2. F12 ‚Üí Network tab
3. –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π —Ç—Ä–µ–∫
4. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `api-v2.soundcloud.com`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `client_id` –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
6. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö ID

### 2. –û–±–Ω–æ–≤–∏—Ç–µ .env —Ñ–∞–π–ª

```env
# –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ ID:
# SOUNDCLOUD_CLIENT_ID=old_single_id

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ ID:
SOUNDCLOUD_CLIENT_IDS=id1,id2,id3

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):
CLIENT_ID_ROTATION_STRATEGY=failover
CLIENT_ID_COOLDOWN_SECONDS=300
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
python main.py
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
[INFO] ClientIDManager initialized with 3 client IDs, strategy: failover
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–≤—ã–π ID –ø–æ–∫–∞ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–∏ –æ—à–∏–±–∫–µ 401/403 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π
- Failed ID –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ cooldown –ø–µ—Ä–∏–æ–¥–∞
- –í—Å—ë –ø—Ä–æ–∑—Ä–∞—á–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –°—Ç—Ä–∞—Ç–µ–≥–∏–∏

**Failover** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–∏–Ω ID –¥–æ –µ–≥–æ –ø–∞–¥–µ–Ω–∏—è
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π

**Round-robin**:
- –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
- –°–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –∫–∞–∂–¥—ã–π ID

## –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
python -m pytest tests/test_client_id_manager.py -v
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/api/client_id_manager.py   # –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—É–ª–∞ ID
src/api/client.py               # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API
src/config/settings.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
tests/test_client_id_manager.py # Unit —Ç–µ—Å—Ç—ã
```

### API

```python
from src.api.client_id_manager import ClientIDManager

manager = ClientIDManager(
    client_ids=['id1', 'id2'],
    strategy='failover',
    cooldown_seconds=300
)

# –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π ID
active_id = await manager.get_active_id()

# –ü–æ–º–µ—Ç–∏—Ç—å —É—Å–ø–µ—Ö/–æ—à–∏–±–∫—É
await manager.mark_success(active_id)
await manager.mark_failed(active_id, 401)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = manager.get_stats()
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[CLIENT_ID_ROTATION.md](docs/CLIENT_ID_ROTATION.md)** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- **[TESTING_ROTATION.md](docs/TESTING_ROTATION.md)** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **[FEATURE_SUMMARY.md](FEATURE_SUMMARY.md)** - –û–±–∑–æ—Ä —Ñ–∏—á–∏

## –í–æ–ø—Ä–æ—Å—ã?

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤—ã—à–µ
2. –ò–∑—É—á–∏—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
3. –°–æ–∑–¥–∞–π—Ç–µ issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã
